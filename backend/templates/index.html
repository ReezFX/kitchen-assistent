<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kitchen Assistant</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/apple-style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@13.0.1/dist/markdown-it.min.js"></script>
    <script src="{{ url_for('static', filename='js/i18n.js') }}"></script>
</head>
<body class="h-full">
    <div class="app-container">
        <!-- Header -->
        <header class="apple-header">
            <div class="container mx-auto px-4">
                <div class="flex items-center justify-between">
                    <a href="/" class="flex items-center">
                        <i class="fas fa-utensils text-xl mr-1" style="color: var(--color-primary);"></i>
                        <h1 class="text-lg font-bold" data-i18n="general.app_title">Kitchen Assistant</h1>
                    </a>
                    
                    <!-- Desktop Navigation -->
                    <nav class="hidden md:flex items-center space-x-4">
                        <a href="#" class="apple-nav-link active" data-i18n="navigation.recipes">Recipes</a>
                        <div class="language-toggle flex rounded-lg overflow-hidden border border-gray-200 ml-3">
                            <button id="lang-en-desktop" data-language="en" class="px-2 py-1 text-xs font-medium" style="background-color: var(--color-primary); color: white;">EN</button>
                            <button id="lang-de-desktop" data-language="de" class="px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 hover:bg-gray-200">DE</button>
                        </div>
                    </nav>
                    
                    <!-- Mobile Menu Button -->
                    <button id="mobile-menu-button" class="md:hidden text-gray-500 focus:outline-none">
                        <i class="fas fa-bars text-lg"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Mobile Menu Overlay -->
        <div id="mobile-menu" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden">
            <div class="fixed inset-y-0 right-0 max-w-xs w-full bg-white dark:bg-gray-900 z-50 transform transition-transform duration-300 translate-x-full">
                <div class="p-4">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-base font-semibold" data-i18n="navigation.menu">Menu</h2>
                        <button id="close-mobile-menu" class="text-gray-500 hover:text-gray-700 focus:outline-none">
                            <i class="fas fa-times text-lg"></i>
                        </button>
                    </div>
                    
                    <nav class="space-y-4">
                        <a href="#" class="block text-base font-medium text-gray-900 hover:text-primary" data-i18n="navigation.recipes">Recipes</a>
                        
                        <div class="pt-4 border-t border-gray-200">
                            <p class="text-xs text-gray-500 mb-2" data-i18n="navigation.language">Language</p>
                            <div class="language-toggle-mobile flex rounded-lg overflow-hidden border border-gray-200 w-max">
                                <button id="lang-en-mobile" data-language="en" class="px-2 py-1 text-xs font-medium" style="background-color: var(--color-primary); color: white;">EN</button>
                                <button id="lang-de-mobile" data-language="de" class="px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 hover:bg-gray-200">DE</button>
                            </div>
                        </div>
                    </nav>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="flex-grow pt-6 pb-20">
            <!-- Combined Hero + Search Section -->
            <section class="container mx-auto px-4 mb-8 section-gap">
                <div class="max-w-4xl mx-auto apple-card p-5">
                    <h2 class="text-xl font-bold mb-3" data-i18n="home.welcome_title">Welcome to Kitchen Assistant</h2>
                    <p class="text-gray-600 mb-4" data-i18n="home.welcome_text">Find your next culinary adventure with our curated collection of recipes.</p>
                    
                    <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3">
                        <input type="text" 
                               id="search-input" 
                               data-i18n-placeholder="home.search_placeholder"
                               placeholder="Search recipes..." 
                               class="apple-input flex-1">
                        <button type="submit" class="btn btn-primary" data-i18n="home.search_button">
                            Search
                        </button>
                    </div>
                </div>
            </section>

            <!-- Recipe Grid with Search & Filters Combined -->
            <section class="container mx-auto px-4 section-gap">
                <div class="recipes-container">
                    <!-- Left Side: Filters Panel -->
                    <div class="filters-panel">
                        <h3 class="section-title">Filters</h3>
                        <div class="filter-group">
                            <span class="filter-label">Dietary:</span>
                            <div class="filter-options">
                                <button class="recipe-tag filter-tag" data-tag="vegetarian">Vegetarian</button>
                                <button class="recipe-tag filter-tag" data-tag="vegan">Vegan</button>
                                <button class="recipe-tag filter-tag" data-tag="gluten-free">Gluten-Free</button>
                            </div>
                        </div>
                        <div class="filter-group">
                            <span class="filter-label">Cuisine:</span>
                            <div class="filter-options">
                                <button class="recipe-tag filter-tag" data-tag="italian">Italian</button>
                                <button class="recipe-tag filter-tag" data-tag="asian">Asian</button>
                                <button class="recipe-tag filter-tag" data-tag="mexican">Mexican</button>
                            </div>
                        </div>
                        <div class="filter-group">
                            <span class="filter-label">Meal Type:</span>
                            <div class="filter-options">
                                <button class="recipe-tag filter-tag" data-tag="breakfast">Breakfast</button>
                                <button class="recipe-tag filter-tag" data-tag="dessert">Dessert</button>
                                <button class="recipe-tag filter-tag" data-tag="dinner">Dinner</button>
                            </div>
                        </div>
                        <div class="filter-group">
                            <span class="filter-label">Time:</span>
                            <div class="filter-options">
                                <button class="recipe-tag filter-tag" data-tag="quick">Quick (<30 min)</button>
                                <button class="recipe-tag filter-tag" data-tag="medium">Medium (30-60 min)</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Right Side: Recipe Content -->
                    <div class="recipes-main">
                        <h2 class="section-title">Recipe Collection</h2>
                        
                        <!-- Loading State -->
                        <div id="recipes-loading" class="flex justify-center py-5">
                            <div class="animate-spin rounded-full h-8 w-8 border-b-2" style="border-color: var(--color-primary);"></div>
                        </div>
                        
                        <!-- Recipe Grid -->
                        <div id="recipes-content" class="recipes-grid">
                            <!-- Recipe cards will be generated here -->
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Mobile Navigation Bar -->
        <nav class="mobile-nav md:hidden">
            <a href="#" class="mobile-nav-item active">
                <i class="fas fa-utensils"></i>
                <span data-i18n="navigation.recipes">Recipes</span>
            </a>
            <a href="#" class="mobile-nav-item">
                <i class="fas fa-search"></i>
                <span data-i18n="navigation.search">Search</span>
            </a>
            <a href="#" class="mobile-nav-item">
                <i class="fas fa-filter"></i>
                <span data-i18n="navigation.filters">Filters</span>
            </a>
            <button id="mobile-menu-trigger" class="mobile-nav-item">
                <i class="fas fa-ellipsis-h"></i>
                <span data-i18n="navigation.more">More</span>
            </button>
        </nav>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script>
        // Mobile menu functionality
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenuTrigger = document.getElementById('mobile-menu-trigger');
        const closeMobileMenu = document.getElementById('close-mobile-menu');
        const mobileMenu = document.getElementById('mobile-menu');
        const mobileMenuPanel = mobileMenu.querySelector('div.fixed');
        
        function openMobileMenu() {
            mobileMenu.classList.remove('hidden');
            setTimeout(() => {
                mobileMenuPanel.classList.remove('translate-x-full');
            }, 10);
        }
        
        function closeMobileMenuHandler() {
            mobileMenuPanel.classList.add('translate-x-full');
            setTimeout(() => {
                mobileMenu.classList.add('hidden');
            }, 300);
        }
        
        mobileMenuButton.addEventListener('click', openMobileMenu);
        mobileMenuTrigger.addEventListener('click', openMobileMenu);
        closeMobileMenu.addEventListener('click', closeMobileMenuHandler);
        mobileMenu.addEventListener('click', (e) => {
            if (e.target === mobileMenu) {
                closeMobileMenuHandler();
            }
        });
        
        // Activate filter tags
        const filterTags = document.querySelectorAll('.filter-tag');
        filterTags.forEach(tag => {
            tag.addEventListener('click', () => {
                tag.classList.toggle('active');
                const activeTag = tag.getAttribute('data-tag');
                // Call fetch with active filters
                const searchQuery = document.getElementById('search-input').value;
                fetchRecipes(searchQuery, activeTag);
            });
        });
    </script>
</body>
</html>
